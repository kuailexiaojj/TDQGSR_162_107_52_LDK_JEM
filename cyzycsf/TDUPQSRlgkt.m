function x=TDUPQSRlgkt(a1,b1,v,r,c,e,h,x1)
x=zeros(1,length(x1));
y=zeros(1,length(x1));
% x(1)=0.01;
% y(1)=0.01;
for i=1:length(x1)-1
    % if abs(x(i))>3
    %     x(i)=sign(x(i))*3;
    % end
    % if abs(y(i))>3
    %     y(i)=sign(x(i))*3;
    % end

 if x(i)<0
    k1=h*(-a1.*(x(i)+b1)+(2.*v./(r.^2)).*(x(i)+b1).*exp(-((x(i)+b1).^2)./r.^2)+c.*(y(i)-x(i))+x1(i));
    f1=h*(-e*y(i)-c.*(y(i)-x(i)));
    k2=h*(-a1.*(x(i)+k1/2+b1)+(2.*v./(r.^2)).*(x(i)+k1/2+b1).*exp(-((x(i)+k1/2+b1).^2)./r.^2)+c.*((y(i)+f1/2)-(x(i)+k1/2))+x1(i));
    f2=h*(-e*(y(i)+f1/2)-c.*((y(i)+f1/2)-(x(i)+k1/2)));
    k3=h*(-a1.*(x(i)+k2/2+b1)+(2.*v./(r.^2)).*(x(i)+k2/2+b1).*exp(-((x(i)+k2/2+b1).^2)./r.^2)+c.*((y(i)+f2/2)-(x(i)+k2/2))+x1(i+1));
    f3=h*(-e*(y(i)+f2/2)-c.*((y(i)+f2/2)-(x(i)+k2/2)));
    k4=h*(-a1.*(x(i)+k3+b1)+(2.*v./(r.^2)).*(x(i)+k3+b1).*exp(-((x(i)+k3+b1).^2)./r.^2)+c.*((y(i)+f3)-(x(i)+k3))+x1(i+1));
    f4=h*(-e*(y(i)+f3)-c.*((y(i)+f3)-(x(i)+k3)));
    x(i+1)=x(i)+1/6*(k1+2*k2+2*k3+k4);
    y(i+1)=y(i)+1/6*(f1+2*f2+2*f3+f4); 
 else
    k1=h*(-a1.*(x(i)-b1)+(2.*v./(r.^2)).*(x(i)-b1).*exp(-((x(i)-b1).^2)./r.^2)+c.*(y(i)-x(i))+x1(i));
    f1=h*(-e*y(i)-c.*(y(i)-x(i)));
    k2=h*(-a1.*(x(i)+k1/2-b1)+(2.*v./(r.^2)).*(x(i)+k1/2-b1).*exp(-((x(i)+k1/2-b1).^2)./r.^2)+c.*((y(i)+f1/2)-(x(i)+k1/2))+x1(i));
    f2=h*(-e*(y(i)+f1/2)-c.*((y(i)+f1/2)-(x(i)+k1/2)));
    k3=h*(-a1.*(x(i)+k2/2-b1)+(2.*v./(r.^2)).*(x(i)+k2/2-b1).*exp(-((x(i)+k2/2-b1).^2)./r.^2)+c.*((y(i)+f2/2)-(x(i)+k2/2))+x1(i+1));
    f3=h*(-e*(y(i)+f2/2)-c.*((y(i)+f2/2)-(x(i)+k2/2)));
    k4=h*(-a1.*(x(i)+k3-b1)+(2.*v./(r.^2)).*(x(i)+k3-b1).*exp(-((x(i)+k3-b1).^2)./r.^2)+c.*((y(i)+f3)-(x(i)+k3))+x1(i+1));
    f4=h*(-e*(y(i)+f3)-c.*((y(i)+f3)-(x(i)+k3)));
    x(i+1)=x(i)+1/6*(k1+2*k2+2*k3+k4);
    y(i+1)=y(i)+1/6*(f1+2*f2+2*f3+f4);
end
end